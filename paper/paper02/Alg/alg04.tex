%
% line numbering
%
\renewcommand{\LinesNumbered}{%
	\setboolean{algocf@linesnumbered}{true}%
	\renewcommand{\algocf@linesnumbered}{\everypar={\nl}}}%
%
\let\oldnl\nl% Store \nl in \oldnl
\renewcommand{\nonl}{\renewcommand{\nl}{\let\nl\oldnl}}% Remove line number for one line
%
\ifdefined\varInputAlgos%
\renewcommand{\arraystretch}{1.90}%
%\todo{Do we mean non-recycling or not circulating?}%
\begin{algorithm*}[!h]%
	\DontPrintSemicolon
	\caption{Aggregating $\protect\MCirc$ for arbitrary type for given window $\wndw$ from genesis day to $\daytt_\maxtt$.%
	}\label{algo:code_aggr}%
%  \caption{Moved-coin-approach: Measurement $\protect\MCircM$ for $\mathtt{type}$ (\acs*{fifo}, \acs*{lifo}) within period $\perd$, window $\wndw$.%
%  }\label{algo:code_mcirc_mc}%
%
	\KwData{$ \MSetCbs$                                      \tcc*{Set of cumulated coinbase coins per day}}%
	\KwData{$ \MSetCirc$                                     \tcc*{Set of $\MCirc$ calculated per day, with $1$ day as lookback window}}%
	\KwData{$ \MSetCircAddA$                                 \tcc*{Set of $\MCirc$ calculated per day, with $\wndw$ day as lookback window}}%
	\KwData{$ \MSetCircAddB$                                 \tcc*{Set of $\MCirc$ output adjustments with $\wndw$ day as lookahead window}}%
	$\MSetCircAggr \gets \emptyset$                          \tcc*{Initialize Set of $\MCircAggr$}
%
	\ForEach{$d \in \{0,...,\daytt_\maxtt\}$%
	}{%
		$\MCircAggr \gets {0}$                               \tcc*{Initialize $\MCircAggr$ to be computed for this day}%
		                                                     \tcc*{Step 1: Use $\MCircAggr$ calculated for $d-1$ as base for aggregation at $d$, except for $d=0$}
		\If{$d > 0$}{%
			$\MCircAggr \gets \MSetCircAggr[d-1]$%
		}%
		                                                     \tcc*{Step 2: Add values of day $d$ to aggregation for $w$}%
		\eIf{$d < w$}{%
			$\MCircAggr \gets \MCircAggr + \MSetCbs[d]$      \tcc*{For $d<w$, only coinbase coins represent $\MCirc$}%
		}{%
			$\MCircAggr \gets \MCircAggr + \MSetCircAddA[d]$ \tcc*{For $d\ge{}w$, add $\MCirc$ of day $d$ calculated for lookback window $w$}%
		}%
	                                                         \tcc*{Step 3: Substract/adjust values of day $d-w$}%
		\If{$d \ge w$}{%
			$d_\mathtt{sub} = d - w$                         \tcc*{Get the first day of the last aggregate}%
			$\MCircAggr \gets \MCircAggr - \MSetCirc[d_\mathtt{sub}]$      \tcc*{Substract all }%
			$\MCircAggr \gets \MCircAggr + \MSetCircAddB[d_\mathtt{sub}]$  \tcc*{Add adjusted values}%
		}%
		$\MSetCircAggr \gets \MSetCircAggr \cup \MCircAggr$\\
	}%
	return $\MSetCircAggr$                                   \tcc*{Result: Return daily aggregated $\MCirc$ for window $w$}%
\end{algorithm*}%
\else%
\fi%
